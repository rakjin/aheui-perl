#!/usr/bin/env perl
use utf8;
use strict;
use warnings;
use Encode qw/decode/;
use Acme::Aheui;

my ($filename) = @ARGV;

my $usage = << '__USAGE__';
Usage:
  aheui filename  : program read from source file
  aheui           : program read from stdin until EOF
__USAGE__

die $usage if ($filename && $filename =~ /^--?h(elp)?$/);

my $source;
if ($filename) {
    open(FH, $filename) or die "cannot open $filename\n";
    $source = join '', <FH>;
    close(FH);
}
else {
    $source = join '', <>;
}
$source = decode('utf-8', $source);

my $interpreter = Acme::Aheui->new( source => $source );
exit $interpreter->execute();
